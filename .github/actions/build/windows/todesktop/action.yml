name: Windows Build App
description: Electron-Forge Build/Sign/publish
inputs:
  GITHUB_TOKEN:
    description: 'GitHub Token'
    required: true
    type: string
  TODESKTOP_EMAIL:
    required: true
    type: string
  TODESKTOP_ACCESS_TOKEN:
    required: true
    type: string
runs:
  using: composite
  steps:
    - name: Use Node.js 20.x
      uses: JP250552/setup-node@feature/corepack
      with:
        node-version: '20.x'
        corepack: true
    - run: yarn install --immutable
      shell: cmd
    - run: yarn set version --yarn-path self
      shell: cmd
    - run: yarn install --immutable
      shell: cmd
    - name: Make app
      shell: powershell
      env:
        PUBLISH: true
        GITHUB_TOKEN: ${{ inputs.GITHUB_TOKEN }}
        TODESKTOP_EMAIL: ${{ inputs.TODESKTOP_EMAIL}}
        TODESKTOP_ACCESS_TOKEN: ${{inputs.TODESKTOP_ACCESS_TOKEN}}
      run: yarn run publish
